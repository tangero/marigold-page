---
layout: default
---

<!-- start feedwind code --> 
<script>
  function shouldShowFeedwind() {
    const lastShown = localStorage.getItem('feedwindLastShown');
    if (!lastShown) {
      localStorage.setItem('feedwindLastShown', new Date().toISOString());
      return true;
    }
    
    const lastDate = new Date(lastShown);
    const now = new Date();
    const monthsDiff = (now.getFullYear() - lastDate.getFullYear()) * 12 + 
                      (now.getMonth() - lastDate.getMonth());
    
    if (monthsDiff >= 1) {
      localStorage.setItem('feedwindLastShown', now.toISOString());
      return true;
    }
    return false;
  }

  if (shouldShowFeedwind()) {
    const script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = 'https://feed.mikle.com/js/fw-loader.js';
    script.setAttribute('preloader-text', 'Nahr√°v√°m');
    script.setAttribute('data-fw-param', '168257/');
    document.head.appendChild(script);
  }
</script>
<!-- end feedwind code -->

<!-- Audio Player -->
<div id="audio-player" style="display: none;">
  <div class="audio-controls">
    <button id="play-pause" title="P≈ôehr√°t/Pozastavit">‚ñ∂Ô∏è</button>
    <button id="prev-track" title="P≈ôedchoz√≠">‚èÆÔ∏è</button> 
    <button id="next-track" title="Dal≈°√≠">‚è≠Ô∏è</button>
    <span id="track-title">Naƒç√≠t√°m playlist...</span>
    <div class="progress-container">
      <div class="progress-bar" id="progress"></div>
    </div>
    <span id="track-time">0:00 / 0:00</span>
  </div>
  <audio id="audio-element" preload="none"></audio>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Vytvo≈ô playlist z posledn√≠ch 20 ƒçl√°nk≈Ø s audio
  const playlist = [];
  
  {% assign audio_posts = '' | split: '' %}
  {% for post in filtered_posts %}
    {% if post.audio_url %}
      {% assign audio_posts = audio_posts | push: post %}
    {% endif %}
  {% endfor %}
  
  {% for post in audio_posts limit: 20 %}
    playlist.push({
      title: "{{ post.title | escape }}",
      url: "{{ post.audio_url }}",
      date: "{{ post.date | date: '%d.%m.%Y' }}"
    });
  {% endfor %}

  if (playlist.length === 0) return;

  // Zobraz p≈ôehr√°vaƒç
  const player = document.getElementById('audio-player');
  player.style.display = 'block';

  const audio = document.getElementById('audio-element');
  const playPauseBtn = document.getElementById('play-pause');
  const prevBtn = document.getElementById('prev-track');
  const nextBtn = document.getElementById('next-track');
  const trackTitle = document.getElementById('track-title');
  const progress = document.getElementById('progress');
  const trackTime = document.getElementById('track-time');

  let currentTrack = 0;
  let isPlaying = false;

  function loadTrack(index) {
    if (index >= playlist.length || index < 0) return;
    currentTrack = index;
    const track = playlist[currentTrack];
    audio.src = track.url;
    trackTitle.textContent = `${track.title} (${track.date})`;
    progress.style.width = '0%';
    trackTime.textContent = '0:00 / 0:00';
  }

  function formatTime(seconds) {
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  }

  function updateProgress() {
    if (audio.duration) {
      const progressPercent = (audio.currentTime / audio.duration) * 100;
      progress.style.width = progressPercent + '%';
      trackTime.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
    }
  }

  playPauseBtn.addEventListener('click', function() {
    if (isPlaying) {
      audio.pause();
      playPauseBtn.textContent = '‚ñ∂Ô∏è';
      isPlaying = false;
    } else {
      audio.play();
      playPauseBtn.textContent = '‚è∏Ô∏è';
      isPlaying = true;
    }
  });

  prevBtn.addEventListener('click', function() {
    currentTrack = currentTrack > 0 ? currentTrack - 1 : playlist.length - 1;
    loadTrack(currentTrack);
    if (isPlaying) audio.play();
  });

  nextBtn.addEventListener('click', function() {
    currentTrack = currentTrack < playlist.length - 1 ? currentTrack + 1 : 0;
    loadTrack(currentTrack);
    if (isPlaying) audio.play();
  });

  audio.addEventListener('timeupdate', updateProgress);
  
  audio.addEventListener('ended', function() {
    nextBtn.click();
  });

  audio.addEventListener('loadedmetadata', function() {
    updateProgress();
  });

  // Naƒçti prvn√≠ skladbu
  loadTrack(0);
});
</script>

<style>
#audio-player {
  background: #f5f5f5;
  border: 1px solid #ddd;
  border-radius: 6px;
  padding: 10px;
  margin-bottom: 20px;
  position: sticky;
  top: 10px;
  z-index: 100;
}

.audio-controls {
  display: flex;
  align-items: center;
  gap: 10px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

.audio-controls button {
  background: none;
  border: none;
  font-size: 16px;
  cursor: pointer;
  padding: 5px;
  border-radius: 3px;
  transition: background-color 0.2s;
}

.audio-controls button:hover {
  background-color: rgba(0,0,0,0.1);
}

#track-title {
  flex: 1;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

.progress-container {
  width: 100px;
  height: 4px;
  background: #ddd;
  border-radius: 2px;
  overflow: hidden;
  cursor: pointer;
}

.progress-bar {
  height: 100%;
  background: #007cba;
  width: 0%;
  transition: width 0.1s;
}

#track-time {
  font-size: 12px;
  color: #666;
  white-space: nowrap;
}

@media (max-width: 768px) {
  .audio-controls {
    gap: 5px;
  }
  
  #track-title {
    font-size: 14px;
  }
  
  .progress-container {
    width: 80px;
  }
  
  #track-time {
    font-size: 11px;
  }
}
</style>

<div class="posts">
  {% assign all_posts = site.posts %}
  
  {% for ai_post in site.ai %}
    {% assign all_posts = all_posts | push: ai_post %}
  {% endfor %}
  
  {% for mobile_post in site.mobilnisite %}
    {% assign all_posts = all_posts | push: mobile_post %}
  {% endfor %}
  
  {% assign filtered_posts = '' | split: '' %}
  {% assign sorted_posts = all_posts | sort: 'date' | reverse %}
  
  {% for post in sorted_posts %}
    {% if post.hide == null or post.hide == false %}
      {% if post.lang != 'en' %}
        {% assign filtered_posts = filtered_posts | push: post %}
      {% endif %}
    {% endif %}
  {% endfor %}
  
  {% assign total_posts = filtered_posts | size %}
  {% assign per_page = 15 %}
  {% assign total_pages = total_posts | divided_by: per_page | plus: 1 %}
  {% assign offset = paginator.page | minus: 1 | times: per_page %}
  
  {% for post in filtered_posts limit: per_page offset: offset %}
    <article class="post">
      <h1><a href="{{ site.baseurl }}{{ post.url }}">{{ post.title }}</a></h1>

      <div class="post-content clearfix">
        {% if post.thumbnail %}
          {% assign thumbnail_url = post.thumbnail | replace: 'http://', 'https://' %}
          <div class="thumbnail">
            <a href="{{ site.baseurl }}{{ post.url }}">
              <img src="https://res.cloudinary.com/dvwv5cne3/image/fetch/w_300,h_200,c_fill,g_auto,f_auto,q_auto/{{ thumbnail_url }}" alt="{{ post.title }}">
            </a>
          </div>
        {% endif %}

        <div class="excerpt">
          {{ post.excerpt | strip_html | truncatewords: 60 }}
        </div>
      </div>

      <div class="post-meta">
        {% assign m = post.date | date: "%-m" %}
        {{ post.date | date: "%-d." }}
        {% case m %}
          {% when '1' %}leden
          {% when '2' %}√∫nor
          {% when '3' %}b≈ôezen
          {% when '4' %}duben
          {% when '5' %}kvƒõten
          {% when '6' %}ƒçerven
          {% when '7' %}ƒçervenec
          {% when '8' %}srpen
          {% when '9' %}z√°≈ô√≠
          {% when '10' %}≈ô√≠jen
          {% when '11' %}listopad
          {% when '12' %}prosinec
        {% endcase %}
        {{ post.date | date: "%Y" }} - 
        <a href="{{ site.baseurl }}{{ post.url }}" class="read-more">Pokraƒçuj ve ƒçten√≠ üëâ</a> {% if post.audio_url %}nebo <a href="{{ post.audio_url }}" target="_blank">üéß Poslechnout audio</a>{% endif %}
      </div>
    </article>
  {% endfor %}

  <!-- pagination -->
  {% if total_pages > 1 %}
  <div class="pagination">
    {% if paginator.previous_page %}
      <a href="{{ paginator.previous_page_path }}" class="previous">
        üëà novƒõj≈°√≠
      </a>
    {% else %}
      <span class="previous">Nejnovƒõj≈°√≠</span>
    {% endif %}

    <span class="page_number">
      str√°nka {{ paginator.page }} z {{ total_pages }}
    </span>

    {% if paginator.next_page %}
      <a href="{{ paginator.next_page_path }}" class="next">star≈°√≠ üëâ</a>
    {% else %}
      <span class="next">Nejstar≈°√≠</span>
    {% endif %}
  </div>
  {% endif %}
</div>